Description

As an architect, I require that a SBB artifact should be created for building instructions in OMS which will serve as its solution for the Wawa digital platform.

Acceptance criteria

GIVEN a SBB for order routing
WHEN the SBB details the solution for routing
THEN the SBB will be considered as the solution for order routing for Wawa digital platform,

GIVEN a SBB for order routing to store
WHEN the SBB details the solution for routing of order to store
THEN the SBB will be referred for reference implementation of order routing functionalities in OMS fulfillment system.


NOTE: The document status should be approved in confluence and linked to this user story, for marking it as complete.

Reference Link - 
https://wawaappdev.atlassian.net/wiki/spaces/ENTERPRISE/pages/486474701/Order+Fulfillment+Flows

The problem statement covers the below points
1 - Order route to store for finished goods
2 - Work order route to kitchen workcell for prepared good
3 - Work order and Order route to delivery workstations

Scope - Currently in Wawa route to store with nearest location of customer address is not in scope.

Context
----------------
Order placed by customer must route to corresponding store for fulfillment where store sells prepared items and finished products.

Following points helps to use this SBB
1 - Order placed by customer have finished product and customer has choose the store for fulfillment.
2 - Order placed by customer have prepared product and customer has choose the store for fulfillment.
3 - Prepared product must have workorder/task for store kitchen system.
4 - Routing to delivery workstation once the task completed at kitchen work station.

If any ordered item/product is prepared within the Wawa store then its termed as prepared product such as Hoagie, sandwich, milkshake, bowl etc. Wawa manufactured
item or third-party item which is already packaged and ready to be sold is termed as finished product such as bottle of water, a bag of chips, soda can, prepackaged sandwiches etc.

Solution
----------------
Wawa will use Sterling OMS as the fulfillment system which will help in routing the orders to specified stores.
WorkCells in a store
Following workcell type should same with product type.
a - RSS – to make sandwiches (hoagies)
b - BEV – to prepare beverages (milkshakes)
c - BOW – to make a bowl of salad
d - EOP - Off-Premise Expeditor

Application platform-->Participant Modeling-->Participant Setup-->Create
2 - Creating custom node type as “WorkCell” and “Expeditor”

Delivery workstation is termed as ‘Off-Premise Expeditor’. 
Application platform-->Participant Modeling--> Node Types--> Create

3 - Workcell/Counter and delivery workstation as child store in fulfillment system

With the help of location feed ( ) store, workcell and expeditor will generate. Also for few can be done manually from OMS configurator. 
Application platform-->Participant Modeling-->Participant Setup-->Create. Choose appropriate node type with respect to workstation and expeditor.

4 - Custom entry to track store open, queue counter, Workcell type, current queue time
Wawa has specific process time/build time for each product which can be maintain with custom table entry. Below sample will help to create custom table to store data. 


5 - Route work order to Kitchen work station inside store
Workorder/task will create for prepared product line of order during schedule<Link SBB-Schedule>. On Success of work order event the prepared order-line will route to kitchen work-cell based on product type.
The entry for preparation time of product can be get by calling “getItemList” api. Also current queue count, current queue time, store open or not should have entry in custom table which can be get by calling “getShipNodeList” api . There should be a custom logic to route the item based on current queue time and preparation time of the the item(if the store is opened). 
CurrentQueueTime should be “CurrentQueueTime + Preparation time”
Also once order received by any workstation then it should be “CurrentQueueCounter + 1”
Call manageOrganizationHierarchy api to update the calculated  queue counter, queue time in custom table so that it will help to use everytime with updated value.

6 - Route completed work-order to delivery work station

7 - No workorder for finished product
If the order holds finished product then that item will route to the store directly. Because for prepared item we are using KitCode="DPK" and  ServiceItemGroupCode="KIT" ServiceItemId="WAWAKITSERVICE" (DPK item) which is not for finished product. Refer to SBB - Schedule. 
8 - Exception
Refer to  SBB-Exception section 1.3



